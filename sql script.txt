#SUNNY'S DATABASE AUTO-GENERATE SCRIPT
#Last updated on JAN 3, 2013

# DEFAULT is fine as long as not manually inserting NULL
# NOT NULL prevents manually inserting NULL

#=============== INITIALIZE DATABASE ===============

CREATE DATABASE  `data` ;

#USER
#SECURITY WARNING: split access data from login info..
CREATE TABLE `data`.`user` (
`uid` INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
`user` VARCHAR(32) NOT NULL,
`pass` VARCHAR(32) NOT NULL,
`salt` VARCHAR(16) NOT NULL,
`mail` VARCHAR(64) NOT NULL,
`name` VARCHAR(32),
`bday` DATE,
`bio` VARCHAR(1000),
`share` VARCHAR(128),
`perm` TINYINT UNSIGNED NOT NULL DEFAULT 0,
`reg_key` VARCHAR(16),  # maybe merge with perm..
`last` DATE
) ENGINE = MYISAM DEFAULT CHARSET=utf8;

#MEDIA HANDLER
CREATE TABLE  `data`.`handler` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
`uid` INT UNSIGNED NOT NULL,
`title` VARCHAR(64) NOT NULL,
`desc` VARCHAR(128),
`type` VARCHAR(4) NOT NULL,
`cat` VARCHAR(16) NOT NULL,
`tag` VARCHAR(255),
`point` MEDIUMINT UNSIGNED NOT NULL DEFAULT 0,
`perm` TINYINT UNSIGNED NOT NULL DEFAULT 0,
`date` TIMESTAMP NOT NULL,
`thumb` VARCHAR(255),
`log` VARCHAR(128)  # some admin message?
) ENGINE = MYISAM DEFAULT CHARSET=utf8;

#VIDEO
CREATE TABLE  `data`.`video` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`vid` BIGINT UNSIGNED NOT NULL ,
`part` TINYINT UNSIGNED DEFAULT 1 ,
`title` VARCHAR(128) ,  # show some words if it's NULL..
`desc` VARCHAR(1000) ,
`dur` SMALLINT UNSIGNED NOT NULL DEFAULT 0 ,
`src` VARCHAR(16) NOT NULL ,
`url` VARCHAR(255) NOT NULL ,
`date` TIMESTAMP NOT NULL
) ENGINE = MYISAM DEFAULT CHARSET=utf8;

#TEXTS
CREATE TABLE  `data`.`text` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`txt` BIGINT UNSIGNED NOT NULL ,
`part` TINYINT UNSIGNED DEFAULT 1 ,
`title` VARCHAR(128) ,
`text` TEXT NOT NULL ,
`date` TIMESTAMP NOT NULL
) ENGINE = MYISAM DEFAULT CHARSET=utf8;

#CODE
CREATE TABLE `data`.`code` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`code` BIGINT UNSIGNED NOT NULL ,
`part` TINYINT UNSIGNED DEFAULT 1 ,
`title` VARCHAR(128) ,
`desc` VARCHAR(255) ,
`src` TEXT NOT NULL ,
`date` TIMESTAMP NOT NULL
) ENGINE = MYISAM DEFAULT CHARSET=utf8;

#SCRIPT PAGE
# not safe unless internal pages
CREATE TABLE `data`.`page` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`page` BIGINT UNSIGNED NOT NULL ,
`file` VARCHAR(64) NOT NULL
) ENGINE = MYISAM DEFAULT CHARSET=utf8;

#COMMENTS
# this table makes no sense?!?!?!?
CREATE TABLE  `data`.`comments` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`cid` BIGINT UNSIGNED NOT NULL ,
`uid` INT UNSIGNED NOT NULL ,
`time` TIMESTAMP NOT NULL ,
`comment` VARCHAR(255) NOT NULL
) ENGINE = MYISAM DEFAULT CHARSET=utf8;

#cid = id of source


CREATE DATABASE  `danmaku` ;

#DANMAKKU
CREATE TABLE  `danmaku`.`cmt#` (
`id` SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`stime` FLOAT UNSIGNED NOT NULL ,
`mode` TINYINT UNSIGNED NOT NULL ,
`size` TINYINT UNSIGNED NOT NULL , #OR maybe char(3)
`color` MEDIUMINT UNSIGNED NOT NULL ,
`date` TIMESTAMP NOT NULL ,
`message` VARCHAR(1000) NOT NULL ,
`lock` BOOLEAN NOT NULL DEFAULT 0 ,
`uid` INT UNSIGNED DEFAULT 0
) ENGINE = MYISAM DEFAULT CHARSET=utf8;


#========== DROP DATABASE(TESTING PURPOSES) ==========
#DROP DATABASE IF EXISTS `data`;
#DROP DATABASE IF EXISTS `danmaku`;


#==================== COMMANDS ====================

#insert data general data
#mysql_query("INSERT INTO `Handler` (`uid`, `title`, `media`, `category`, `tags`) VALUES ('123','test','vid','rand',null)");

#get max available id
/*
$exe = mysql_query("SELECT MAX(id) FROM `handler` LIMIT 1");
$high = mysql_fetch_array($exe);
echo $high[0];
*/
